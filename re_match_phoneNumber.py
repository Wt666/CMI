
# mnc_dict = {
# "4121579*":"22851",
# "4122579*":"22851",
# "4124579*":"22851",
# "4126579*":"22851",
# "4127579*":"22851",
# "4131579*":"22851",
# "4132579*":"22851",
# "4133579*":"22851",
# "4134579*":"22851",
# "4141579*":"22851",
# "4144579*":"22851",
# "4152579*":"22851",
# "4155579*":"22851",
# "4156579*":"22851",
# "4158979*":"22851",
# "4161579*":"22851",
# "4162579*":"22851",
# "4171579*":"22851",
# "4174279*":"22851",
# "4179977*":"22851",
# "4179978*":"22851",
# "4179979*":"22851",
# "4181579*":"22851",
# "4186021579*":"22851",
# "4186022579*":"22851",
# "4186024579*":"22851",
# "4186026579*":"22851",
# "4186027579*":"22851",
# "4186031579*":"22851",
# "4186032579*":"22851",
# "4186033579*":"22851",
# "4186034579*":"22851",
# "4186041579*":"22851",
# "4186044579*":"22851",
# "4186052579*":"22851",
# "4186055579*":"22851",
# "4186056579*":"22851",
# "4186058979*":"22851",
# "4186061579*":"22851",
# "4186062579*":"22851",
# "4186071579*":"22851",
# "4186074279*":"22851",
# "4186079977*":"22851",
# "4186079978*":"22851",
# "4186079979*":"22851",
# "4186081579*":"22851",
# "4186091279*":"22851",
# "4191279*":"22851",
# "4178[2-3]*":"22803",
# "4178480[0-9]*":"22803",
# "4178[6-9]*":"22803",
# "4176001*":"22802",
# "4176[2-7]*":"22802",
# "41768[0-7]*":"22802",
# "417687[0-7]*":"22802",
# "41772*":"22802",
# "417730[0-9]*":"22802",
# "417731[0-5]*":"22802",
# "4177360000":"22802",
# "41512*":"22801",
# "41750*":"22801",
# "41751[0-9]*":"22801",
# "41751[23]*":"22801",
# "417517*":"22801",
# "417519*":"22801",
# "41752[0-3]*":"22801",
# "41752400000*":"22801",
# "41754*":"22801",
# "41755[0-7]*":"22801",
# "41770*":"22801",
# "41771[0-3]*":"22801",
# "417715*":"22801",
# "417717*":"22801",
# "417719*":"22801",
# "41774*":"22801",
# "41775[0-3]*":"22801",
# "41778[01]*":"22801",
# "41779*":"22801",
# "4179[0-8]*":"22801",
# "41799[0-6]*":"22801",
# "418607[5-8]*":"22801",
# "41860799[0-6]*":"22801",
# }

mnc_dict = {
"977980+":"Nepal_NCELL",
"977981+":"Nepal_NCELL",
"977982+":"Nepal_NCELL",
"977970+":"Nepal_NCELL",
"977984+":"Nepal_NTC",
"977985+":"Nepal_NTC",
"977986+":"Nepal_NTC",
"97797[45]+":"Nepal_NTC",
"977+":"Nepal",
'31+':'Netherlands',
'3161[023]+':'Netherlands_KPN Mobile',
'3162[023]+':'Netherlands_KPN Mobile',
'31630+':'Netherlands_KPN Mobile',
'3165[137]+':'Netherlands_KPN Mobile',
'3168[23]+':'Netherlands_KPN Mobile',
'319700[23]+':'Netherlands_KPN Mobile',
'3167670+':'Netherlands_KPN Mobile',
'319701[123678]+':'Netherlands_KPN Mobile',
'319702[012]+':'Netherlands_KPN Mobile',
'3197030+':'Netherlands_KPN Mobile',
'599+':'Netherlands Antilles',
'3168[4-7]+':'Netherlands_Lycamobile',
'3187[1-4]+':'Netherlands_Lycamobile',
'3161[679]+':'Netherlands_TELFORT',
'31626+':'Netherlands_TELFORT',
'31633+':'Netherlands_TELFORT',
'3164[4579]+':'Netherlands_TELFORT',
'31636[0-5]+':'Netherlands_Tele2',
'31640+':'Netherlands_Tele2',
'31618+':'Netherlands_Tmobile_Orange',
'31628+':'Netherlands_Tmobile_Orange',
'3163[89]+':'Netherlands_Tmobile_Orange',
'31648+':'Netherlands_Tmobile_Orange',
'31624+':'Netherlands_Tmobile_Orange',
'31614+':'Netherlands_Tmobile_Orange',
'3164[123]+':'Netherlands_Tmobile_Orange',
'31634+':'Netherlands_Tmobile_Orange',
'31681+':'Netherlands_Tmobile_Orange',
'31656[01]+':'Netherlands_Tmobile_Orange',
'31632[012]+':'Netherlands_Tmobile_Orange',
'3197005[0-4]+':'Netherlands_Tmobile_Orange',
'3161[15]+':'Netherlands_Vodafone',
'3162[1579]+':'Netherlands_Vodafone',
'31631+':'Netherlands_Vodafone',
'31646+':'Netherlands_Vodafone',
'3165[02]+':'Netherlands_Vodafone',
'31654+':'Netherlands_Vodafone',
'31655+':'Netherlands_Vodafone',
'3197001+':'Netherlands_Vodafone',
'31635[789]+':'Netherlands_Vodafone',
'3197004+':'Netherlands_Vodafone',
'3197005[56789]+':'Netherlands_Vodafone',
'3197014[0-6]+':'Netherlands_Vodafone',
'3197019+':'Netherlands_Vodafone',
'218+':'Libya',
'21892+':'Libya_LibyanaMobile',
'21894+':'Libya_LibyanaMobile',
'92+':'Pakistan',
'9231+':'Pakistan_Cmpak',
'9237+':'Pakistan_Cmpak',
'9235[345678]+':'Pakistan_SCO',
'9230+':'Pakistan_TW1-Mobilink',
'9234+':'Pakistan_Telenor',
'9233[0-6]+':'Pakistan_Ufone',
'9232[0-4]+':'Pakistan_Warid Telecom',
'964+':'Iraq',
'96477[0-5]+':'Iraq_Asiacell',
'9647760+':'Iraq_Asiacell',
'96478[0-3]+':'Iraq_Atheer_Telecom',
'96479[0]+':'Iraq_Atheer_Telecom',
'96475[012]+':'Iraq_Korek_Telecom',
'96466[2-7]+':'Iraq_Regional_Telecom',
'96462[2-9]+':'Iraq_Regional_Telecom',
'21891+':'Libya21891+',
'96475+':'Iraq_Korek_Telecom96475+',

}
from tqdm import tqdm
import pandas as pd
import re

def match_phone_numbers(phone_numbers, regex_patterns):
    results = []
    results_mnc = []
    for number in tqdm(phone_numbers):
        number = number.replace("'","")
        matches = []
        DEST_OPER_IDs = []
        for pattern in regex_patterns:
            if re.match(pattern, number):
                matches.append(pattern)
                DEST_OPER_IDs.append(mnc_dict.get(pattern))
        if matches==[]:
            matches = ['default']
            DEST_OPER_IDs = ['xxx']
        results.append(matches)
        results_mnc.append(DEST_OPER_IDs)
    return results, results_mnc

# 示例输入数据
# phone_numbers = [
# '417996689121',
# '41799672434',
# '41799672504',
#
# ]
phone_numbers = pd.read_excel(r'phoneNBs.xlsx', dtype=str)['phoneNB_E164']
regex_patterns = mnc_dict.keys()

# 调用函数进行匹配
matched_results, results_mnc = match_phone_numbers(phone_numbers, regex_patterns)


# 创建一个字典，将列表数据作为值，列名作为键
data = {'Column1': phone_numbers, 'Column2': matched_results, 'Column3': results_mnc}
# 创建一个DataFrame
df = pd.DataFrame(data)
# 导出为Excel文件
df.to_excel('output.xlsx', index=False)

# # 输出匹配结果
# for i, number in enumerate(phone_numbers):
#     print(f'{number}: {matched_results[i]}: {results_mnc[i]}')